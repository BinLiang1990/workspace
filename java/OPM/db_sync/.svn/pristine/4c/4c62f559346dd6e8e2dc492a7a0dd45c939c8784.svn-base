package cn.vobile.opm.dbsync.service;

import java.io.IOException;
import java.io.InputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;

public class UsersRepository {

	private String host;
	private String port;

	public void pullUsers() {
		String url = "http://" + host + ":" + port
				+ "/opm_web_shell/GetAllUsersAction.action";
		try {
			HttpURLConnection httpUrlConnection = (HttpURLConnection) new URL(
					url).openConnection();
			httpUrlConnection.setConnectTimeout(1000 * 60);
			httpUrlConnection.setReadTimeout(1000 * 60);
			httpUrlConnection.setDoOutput(true);
			httpUrlConnection.setDoInput(true);
			httpUrlConnection.setUseCaches(false);
			httpUrlConnection.setRequestProperty("Content-type",
					"application/x-java-serialized-object");
			httpUrlConnection.setRequestMethod("POST");
			httpUrlConnection.connect();
			OutputStream outStrm = httpUrlConnection.getOutputStream();
			ObjectOutputStream objOutputStrm = new ObjectOutputStream(outStrm);
			objOutputStrm.writeObject(new String("我是客户端"));
			objOutputStrm.flush();
			objOutputStrm.close();
			InputStream inStrm = httpUrlConnection.getInputStream();
			ObjectInputStream objInputStrm = new ObjectInputStream(inStrm);
			String string = (String) objInputStrm.readObject();
			System.out.println("客户端收到" + string);
			objInputStrm.close();
		} catch (MalformedURLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	public String getHost() {
		return host;
	}

	public void setHost(String host) {
		this.host = host;
	}

	public String getPort() {
		return port;
	}

	public void setPort(String port) {
		this.port = port;
	}

}
